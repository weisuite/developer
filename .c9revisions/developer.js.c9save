{"ts":1358873682387,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"function dartMainRunner(main){\n    main();\n\tvar listClients,selectProvider,clientForm, createClient, deleteClient;\n\tselectProvider=function(providers,parent){\n\t\tvar i,j,option,selects;\n\t\tif(parent){\n\t\t\tselects=window.WS.queryAll('select[name=\"provider\"]',parent);\t\t\t\n\t\t}else{\n\t\t\tselects=window.WS.queryAll('select[name=\"provider\"]');\t\t\t\n\t\t}\n\n\t\tfor(j=0;j<selects.length;j++){\n\t\t\tfor(i=0;i<providers.length;i++){\n\t\t\t\toption=document.createElement(\"option\");\n\t\t\t\toption.text=providers[i].name;\n\t\t\t\toption.value=providers[i].key;\n\t\t\t\tselects[j].appendChild(option);\n\t\t\t\tif(providers[i].key==selects[j].getAttribute(\"data-value\")){\n\t\t\t\t\toption.selected=true;\n\t\t\t\t}\n\t\t\t}\t\n\t\t}\t\t\t\n\t};\n\tcreateClient=function(client,load){\n\t\t   //json content-type is required for ws reclisource post\n\t\t\twindow.WS.ajax(\"/api/core/clients\", {\n\t\t\t\t\"method\" : \"POST\",\n\t\t\t\t\"data\":client,\n\t\t\t\t\"headers\":{\n\t\t\t\t\t\"Content-Type\":\"application/json\"\n\t\t\t\t}\n\t\t\t}, load);\t\t\t\n\t};\n\tdeleteClient=function(clientKey,load){\n\t\twindow.WS.ajax(\"/api/core/clients/\"+clientKey, {\n\t\t\t\"method\" : \"DELETE\"\n\t\t}, load);\t\t\t\t\n\t};\n\tlistClients=function(providers){\n\t\twindow.WS.ajax(\"/api/core/clients\", {\n\t\t\t\"method\" : \"GET\",\n\t\t\t\"data\":{\"owner\":getUser().key}\n\t\t}, function(req) {\n\t\t\twindow.WS.hideMessage();\n\t\t\tvar ul,clients,i,html;\n\t\t\tclients = JSON.parse(req.responseText);\n\t\t\tul=window.WS.query('ul.clients');\n\t\t\tvar addClient=function(client){\n\t\t\t\tli=document.createElement(\"li\");\n\t\t\t\thtml =\"<div><span class='label'>Key:</span><span>\"+client.key+\"</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>Provider:</span><select name='provider' data-value=\"+client.provider+\"></select></div>\";\t\t\t\n\t\t\t\thtml+=\"<div><span class='label'>Client ID:</span><span>\"+client.clientId+\"</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>Client Secret:</span><span>***********</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>Redirection Endpoint:</span><span>\"+client.redirectionEndpoint+\"</span></div>\";\t\t\t\t\t\n\t\t\t\thtml+=\"<div><span class='label'>Domains:</span><span>\"+client.domains+\"</span></div>\";\t\t\t\t\n\t\t\t\thtml+=\"<div><span class='label'>Description:</span><span>\"+client.description+\"</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>Updated At:</span><span>\"+new Date(client.updatedAt)+\"</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>BatchedAt:</span><span>\"+new Date(client.batchedAt)+\"</span></div>\";\n\t\t\t\thtml+=\"<div><span class='label'>CreatedAt:</span><span>\"+new Date(client.createdAt)+\"</span></div>\";\n\t\t\t\thtml+=\"<br/><a class='button delete' data-key='\"+client.key+\"'><span>Delete</span></a>\";\n\t\t\t\tli.innerHTML=html;\n\t\t\t\tul.appendChild(li);\n\t\t\t};\n\t\t\tfor(i=0;i<clients.length;i++){\n\t\t\t\taddClient(clients[i]);\n\t\t\t}\n\t\t\tselectProvider(providers,ul);\n\t\t\twindow.WS.query('a.button.delete',ul).addEventListener('click',function(event){\n\t\t\t\tdeleteClient(this.getAttribute(\"data-key\"),function(req){\n\t\t\t\t\tlocation.reload();\n\t\t\t\t});\n\t\t\t},false);\t\t\t\n\t\t});\t\t\t\t\n\t};\n\t\n\twindow.WS.ajax(\"/api/core/providers\", {\n\t\t\"method\" : \"GET\"\n\t}, function(req) {\n\t\tvar providers;\n\t\tproviders = JSON.parse(req.responseText);\n\t\tselectProvider(providers);\n\t\tlistClients(providers);\n\t});\t\n\tclientForm=window.WS.query(\"form.client\");\n\n\twindow.WS.query('a.button.create',clientForm).addEventListener('click',function(event){\n\t\tvar data=form2js(clientForm);\n\t\tcreateClient(data,function(req){\n\t\t\tlocation.reload();\n\t\t});\n\t},false);\n}"]],"start1":0,"start2":0,"length1":0,"length2":3352}]],"length":3352}
{"contributors":[],"silentsave":false,"ts":1358873708727,"patch":[[{"diffs":[[0,",load){\n"],[-1,"\t\t"],[1,"     "],[0,"   //jso"]],"start1":706,"start2":706,"length1":18,"length2":21},{"diffs":[[0," post\n\t\t"],[-1,"\t"],[0,"window.W"]],"start1":772,"start2":772,"length1":17,"length2":16},{"diffs":[[0,"\", {\n\t\t\t"],[-1,"\t"],[0,"\"method\""]],"start1":813,"start2":813,"length1":17,"length2":16},{"diffs":[[0,"ST\",\n\t\t\t"],[-1,"\t"],[0,"\"data\":c"]],"start1":835,"start2":835,"length1":17,"length2":16},{"diffs":[[0,"client,\n"],[-1,"\t"],[0,"\t\t\t\"head"]],"start1":850,"start2":850,"length1":17,"length2":16},{"diffs":[[0,"\":{\n\t\t\t\t"],[-1,"\t"],[0,"\"Content"]],"start1":869,"start2":869,"length1":17,"length2":16},{"diffs":[[0,"son\"\n\t\t\t"],[-1,"\t"],[0,"}\n"],[-1,"\t"],[0,"\t\t}, loa"]],"start1":906,"start2":906,"length1":20,"length2":18}]],"length":3348,"saved":false}
{"ts":1358873719154,"patch":[[{"diffs":[[0,"\"owner\":"],[1,"window."],[0,"getUser("]],"start1":1175,"start2":1175,"length1":16,"length2":23}]],"length":3355,"saved":false}
{"ts":1358873728648,"patch":[[{"diffs":[[0,"ients,i,html"],[1,",li"],[0,";\n\t\t\tclients"]],"start1":1266,"start2":1266,"length1":24,"length2":27}]],"length":3358,"saved":false}
{"ts":1358873768697,"patch":[[{"diffs":[[0,"ar data="],[1,"window."],[0,"form2js("]],"start1":3254,"start2":3254,"length1":16,"length2":23}]],"length":3365,"saved":false}
